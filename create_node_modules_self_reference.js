"use strict";

var fs           = require( 'fs' )
  , name         = require( './package.json' ).name
  , node_modules = 'node_modules'
  , toubkal_link = node_modules + '/' + name
;

try {
  if ( fs.existsSync( '../../' + name ) ) {
    console.log( 'we are already in node_modules' );
    
  } else {  
    fs.existsSync( node_modules ) || fs.mkdirSync( node_modules );
    
    console.log( 'check existence of', toubkal_link );
    
    fs.existsSync( toubkal_link )
      ? console.log( 'symlink already exists' )
      
      : fs.symlink( '../.', toubkal_link, 'dir', function( error ) {
          if ( error ) {
             console.log( error );
          } else {
             console.log( 'created symlink to self:', toubkal_link );
          }
        } )
    ;
  }

} catch( e ) {
  console.error( 'error:', e );
}
